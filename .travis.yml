language: c

compiler:
  - gcc
  - clang

os:
  - linux
  - osx

stages:
  - build
  - name: analysis
    if: os = linux

jobs:
  include:
    - stage: build
      script: autoreconf --force && ./configure && make "CFLAGS=-Werror"
    - stage: analysis
      script: autoreconf --force && scan-build ./configure && scan-build --status-bugs make "CFLAGS=-std=gnu99 -Werror"
